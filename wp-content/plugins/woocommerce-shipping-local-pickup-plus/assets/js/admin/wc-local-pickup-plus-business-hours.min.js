(function() {  "use strict";

  /**
   * WooCommerce Local Pickup Plus Business Hours input field handler.
   *
   * This script controls the business hours special custom field and should be
   * included on all admin screens where business hours field is displayed.
   *
   * @since 2.0.0
   */
  jQuery(document).ready(function($) {
    var $field, fieldName, matchColsHeight, pagenow, ref, ref1, wc_local_pickup_plus_admin;
    wc_local_pickup_plus_admin = (ref = window.wc_local_pickup_plus_admin) != null ? ref : {};
    pagenow = (ref1 = window.pagenow) != null ? ref1 : '';

    /*
      * Local pickup plus admin screens.
     */
    if (wc_local_pickup_plus_admin.wc_settings_screen === pagenow || 'wc_pickup_location' === pagenow) {
      $field = $('.wc-local-pickup-plus-business-hours-field');
      fieldName = $field.data('field-name');
      $field.on('click', '.wc-local-pickup-plus-business-hours-set', function(e) {
        var $currentDay, $schedule, data, dayOfWeek;
        e.preventDefault();
        $(this).hide();
        $schedule = $(this).closest('.wc-local-pickup-plus-business-hours-day-of-week-schedule');
        $currentDay = $(this).closest('.wc-local-pickup-plus-business-hours-day-of-week');
        dayOfWeek = $currentDay.data('day-of-week');
        data = {
          action: 'wc_local_pickup_plus_get_time_range_picker_html',
          security: wc_local_pickup_plus_admin.get_time_range_picker_html_nonce,
          name: fieldName + '_' + dayOfWeek
        };
        $.post(wc_local_pickup_plus_admin.ajax_url, data, function(response) {
          if (response.success) {
            return $schedule.append('<li>' + response.data + '</li>');
          } else {
            return console.log(response);
          }
        });
        return matchColsHeight();
      });
      $field.on('click', '.wc-local-pickup-plus-business-hours-add', function(e) {
        var $currentDay, $currentRange, data, dayOfWeek;
        e.preventDefault();
        $currentRange = $(this).closest('li');
        $currentDay = $(this).closest('.wc-local-pickup-plus-business-hours-day-of-week');
        dayOfWeek = $currentDay.data('day-of-week');
        data = {
          action: 'wc_local_pickup_plus_get_time_range_picker_html',
          security: wc_local_pickup_plus_admin.get_time_range_picker_html_nonce,
          name: fieldName + '_' + dayOfWeek
        };
        $.post(wc_local_pickup_plus_admin.ajax_url, data, function(response) {
          if (response.success) {
            return $currentRange.after('<li>' + response.data + '</li>');
          } else {
            return console.log(response);
          }
        });
        return matchColsHeight();
      });
      $field.on('click', '.wc-local-pickup-plus-business-hours-remove', function(e) {
        var $currentRange, $schedule;
        e.preventDefault();
        $currentRange = $(this).closest('li');
        $schedule = $(this).closest('.wc-local-pickup-plus-business-hours-day-of-week-schedule');
        $currentRange.remove();
        if ($schedule.find('> li').size() < 1) {
          $schedule.find('button.wc-local-pickup-plus-business-hours-set').show();
        }
        return matchColsHeight();
      });

      /*
      		 * Matches the height of the columns for each day.
      		 *
      		 * @since 2.0.0
       */
      matchColsHeight = function() {
        var maxHeight;
        maxHeight = 0;
        $('.wc-local-pickup-plus-business-hours-day-of-week').each(function() {
          $(this).css('height', 'auto');
          if ($(this).height() > maxHeight) {
            maxHeight = $(this).height() + 20;
          }
        });
        if (maxHeight > 0) {
          return $('.wc-local-pickup-plus-business-hours-day-of-week').height(maxHeight);
        }
      };
      matchColsHeight();
      $('.pickup_appointments_tab > a').on('click', function(e) {
        return matchColsHeight();
      });
      return $('#_business_hours_enabled').on('click', function(e) {
        return matchColsHeight();
      });
    }
  });

}).call(this);


