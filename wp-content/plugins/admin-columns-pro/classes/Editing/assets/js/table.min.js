function cacie_options_format_editable(e){var a=[];if(void 0===e)return a;for(var t=0;t<e.length;t++){var i;if(void 0!==e[t].options){i={text:e[t].label,children:[]};for(var n in e[t].options)e[t].options.hasOwnProperty(n)&&i.children.push({value:e[t].options[n].value,id:e[t].options[n].value,text:e[t].options[n].label})}else i={value:e[t].value,id:e[t].value,text:e[t].label};a.push(i)}return a}function cacie_esc_regex(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function cacie_is_float(e){var a="";woocommerce_admin.decimal_point&&(a="|"+cacie_esc_regex(woocommerce_admin.decimal_point));var t=new RegExp("^[0-9]+((."+a+")[0-9]+)?$");return e.match(t)}function cacie_get_query_param_from_url(e,a){if(!a)return null;e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=t.exec(a);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function cacie_init(e){window.xeditables=[],window.cacie_edit_enabled=1;var a=e(AC.table_id),t=ACP_Editing_Columns,i=ACP_Editing_Items;for(var n in t)if(t.hasOwnProperty(n)){var c=t[n];if(c.column_name=n,c.editable){if(void 0===c.editable.type||""===c.editable.type)continue;var l,d=c.editable.type;l="cacie_edit_"+d,e(".column-"+n,a).each(function(){if(e(this).hasClass("cacie-editable-container"))return!0;var a,t=e(this).parents("tr").find(".check-column input").val();if(!t){var o=e(this).parents("tr").attr("id");o&&(t=parseInt(o.substr(o.lastIndexOf("-")+1),10))}if(!t){var r=e(this).parents("tr").find(".edit a").attr("href");r&&(t=cacie_get_query_param_from_url("id",r))}if(!(t in i))return!0;a=i[t];var s;if(n in a.columndata&&(s=a.columndata[n].revisions[0]),null==s||void 0===s||void 0!==s.errors)return!0;"select2_dropdown"!=d&&"select2_tags"!=d||0===s.length&&(s=[]),a.columndata[n].value=s,e(this).addClass("cacie-editable-container cacie-editable-"+d),e(this).wrapInner('<span class="inner cacie-editable"></span>');var _=e(this).find(".inner");_.cacie_handle_value(c,a),_.cacie_handle_actions(c,a),_[l](c,a)})}}}function cacie_enable(e){e("#cacie-toggle-edit").addClass("active"),void 0===window.xeditables?cacie_init(e):e(window.xeditables).editable("enable"),e(AC.table_id).addClass("cacie-enabled"),window.cacie_edit_enabled=1}function cacie_disable(e){e("#cacie-toggle-edit").removeClass("active"),e(window.xeditables).editable("disable"),window.cacie_edit_enabled=0,e(AC.table_id).removeClass("cacie-enabled")}var AC,ACP_Editing,ACP_Editing_Columns,ACP_Editing_Items,woocommerce_admin;jQuery(document).ready(function(e){e(".wp-list-table tbody").on("updated","tr",function(){cacie_init(e)}),void 0!==ACP_Editing_Columns&&void 0!==ACP_Editing_Items&&null!=ACP_Editing_Items&&0!==ACP_Editing_Columns.length&&0!==ACP_Editing_Items.length&&(e(".tablenav.top .actions:last").append('<a href="javascript:;" id="cacie-toggle-edit" class="cpac-edit add-new-h2">'+ACP_Editing.i18n.inline_edit+"</a>"),e("#cacie-toggle-edit").on("click",function(a){window.cacie_edit_enabled?cacie_disable(e):cacie_enable(e),e.post(ajaxurl,{action:"acp_editing_state_save",value:window.cacie_edit_enabled,list_screen:AC.list_screen,layout:AC.layout,_ajax_nonce:AC.ajax_nonce}),a.preventDefault()}),!0===ACP_Editing.inline_edit.active&&cacie_enable(e),e(".wp-list-table").on("click",".cacie-editable a",function(a){a.stopPropagation();var t=e(this);t.parent().editable("destroy"),t.parents("td:first").find(".popover").remove(),window.location.href=t.attr("href")}))}),function(e){e.fn.cacie_wrap_images=function(){e(this).find(".ac-image").each(function(){var a=e(this).data("media-id");if(!(e(this).parent(".cacie-item").length>0)){var t=e('<div class="cacie-item"></div>');t.attr("data-cacie-id",a),e(this).wrap(t)}})},e.fn.cacie_show_message=function(a,t){void 0===t?t="":"info"!=t&&"error"!=t&&"success"!=t&&(t="");var i=e("<div />");i.addClass("alert"),t&&i.addClass("alert-"+t),i.append('<button type="button" class="close" data-dismiss="alert">&times;</button>'),i.append(a),e(this).after(i)},e.fn.cacie_after_save=function(a,t,i){var n=e(this);void 0!==i&&n.cacie_set_value(a,t,i),n.closest("td").removeClass("processing"),n.cacie_handle_value(a,t),n.cacie_handle_actions(a,t),n.cacie_remove_ajax_loading(),e(document).trigger("cacie_after_save",a,t,i)},e.fn.cacie_handle_value=function(a,t){var i=e(this),n=i.cacie_get_value(a,t),c=!0;n&&(c=!1),"media"==a.editable.type&&"false"==n&&(c=!0),c?(i.parents("td").removeClass("cacie-nonempty"),i.parents("td").addClass("cacie-empty")):(i.parents("td").addClass("cacie-nonempty"),i.parents("td").removeClass("cacie-empty"))},e.fn.cacie_add_ajax_loading=function(a){var t=e(this),i=t.parents("td").find(".cacie-editable");switch(a.type){case"title":case"name":case"username":i.siblings(".post-state").length&&(i=i.siblings(".post-state").eq(0))}i.after('<div class="spinner cacie-ajax-loading" />')},e.fn.cacie_remove_ajax_loading=function(){e(this).parents("td").find(".cacie-ajax-loading").remove()},e.fn.cacie_restore_revision=function(a,t,i){var n=e(this);t.columndata[a.column_name].current_revision=i;var c=ACP_Editing_Items[t.ID].columndata[a.column_name].revisions,l=ACP_Editing_Items[t.ID].columndata[a.column_name].current_revision;if("is_xeditable"in a.editable&&a.editable.is_xeditable){var d=n.cacie_get_target(a);n.cacie_add_ajax_loading(a),d.editable("setValue",c[l],!0),d.editable("submit")}else n.cacie_savecolumn(a,t,c[l],!1);n.cacie_handle_actions(a,t)},e.fn.cacie_get_target=function(a){var t=e(this);return void 0!==a.editable.js&&void 0!==a.editable.js.selector&&t.find(a.editable.js.selector).length&&(t=t.find(a.editable.js.selector)),t},e.fn.cacie_get_value=function(e,a){return a.columndata[e.column_name].value},e.fn.cacie_set_value=function(e,a,t){a.columndata[e.column_name].value=t},e.fn.cacie_edit_text=function(a,t){var i=e(this);i.cacie_xeditable({type:"text",value:i.cacie_get_value(a,t)},a,t)},e.fn.cacie_edit_url=function(a,t){var i=e(this);i.cacie_xeditable({type:"url",value:i.cacie_get_value(a,t)},a,t)},e.fn.cacie_edit_float=function(a,t){var i=e(this);i.cacie_xeditable({type:"text",value:i.cacie_get_value(a,t),validate:function(e){if(e&&!cacie_is_float(e))return ACP_Editing.i18n.errors.invalid_float}},a,t)},e.fn.cacie_edit_number=function(a,t){var i=e(this);i.cacie_xeditable({type:"number",value:i.cacie_get_value(a,t)},a,t)},e.fn.cacie_edit_password=function(a,t){var i=e(this);i.cacie_xeditable({type:"password",value:i.cacie_get_value(a,t)},a,t)},e.fn.cacie_edit_email=function(a,t){var i=e(this);i.cacie_xeditable({type:"email",value:i.cacie_get_value(a,t)},a,t)},e.fn.cacie_edit_checkboxlist=function(a,t){e(this).cacie_xeditable({type:"checklist"},a,t)},e.fn.cacie_edit_textarea=function(a,t){var i=e(this);i.cacie_xeditable({type:"textarea",rows:10,value:i.cacie_get_value(a,t)},a,t)},e.fn.cacie_edit_select=function(a,t){var i=e(this),n=i.cacie_get_value(a,t),c=a.editable.options;i.cacie_xeditable({type:"select",value:n,source:cacie_options_format_editable(c)},a,t)},e.fn.cacie_edit_select2_dropdown=function(a,t){var i=a.editable.options,n=e(this),c={type:"select2",showbuttons:!0,source:cacie_options_format_editable(i),select2:{width:"230px"}},l=t.columndata[a.column_name];if(void 0!==a.editable.ajax_populate&&a.editable.ajax_populate){var d={source:"",showbuttons:!1,select2:{width:230,minimumInputLength:0,initSelection:function(e,a){var t=[];if(void 0!==l.formattedvalue)for(var i in l.formattedvalue)t.push({id:i,text:l.formattedvalue[i]});1==t.length?a(t[0]):t.length>0&&a(t)},ajax:{url:ajaxurl,dataType:"json",quietMillis:100,data:function(e,i){return{action:"acp_editing_get_options",layout:AC.layout,searchterm:e,page:i,column:a.column_name,list_screen:AC.list_screen,item_id:t.ID,_ajax_nonce:AC.ajax_nonce}},results:function(e){if(e.success){var a=e.data.more;return 0==e.data.options&&(a=!1),{results:cacie_options_format_editable(e.data.options),more:a}}return n.data("editable").input.$input.select2("close"),n.data("editable").container.$form.editableform("error",e.data),{results:[]}}}}};c=e.extend(c,d)}void 0!==a.editable.multiple&&a.editable.multiple&&(c.select2.multiple=!0,c.showbuttons=!0),e(this).cacie_xeditable(c,a,t),void 0!==a.editable.ajax_populate&&a.editable.ajax_populate&&e(this).on("shown",function(){var e=n.data("editable").input.$input;e.on("change",function(){l.formattedvalue=[];var a=e.select2("data");if(void 0!==a.id)l.formattedvalue[a.id]=a.text;else for(var t in a)a.hasOwnProperty(t)&&(l.formattedvalue[a[t].id]=a[t].text)})})},e.fn.cacie_edit_select2_tags=function(a,t){var i=e(this),n=a.editable.options,c=i.cacie_get_value(a,t);"false"!==c&&!1!==c||(c=""),i.cacie_xeditable({type:"select2",value:c,select2:{width:200,tags:cacie_options_format_editable(n)}},a,t)},e.fn.cacie_edit_togglable=function(a,t){var i=e(this),n=a.editable.options;e(this).on("click",function(){if(window.cacie_edit_enabled&&n){var e,c=i.cacie_get_value(a,t),l=n.length,d=0;for(var o in n)if(n.hasOwnProperty(o)&&c==n[o].label){d=n[o].value;break}if(void 0!==a.editable.required&&a.editable.required&&0!==d)return void i.cacie_show_message(ACP_Editing.i18n.errors.field_required);e=n[(d+1)%l].label,i.cacie_savecolumn(a,t,e,!0)}})},e.fn.cacie_edit_media=function(a,t){e(this).cacie_edit_attachment(a,t)},e.fn.cacie_edit_attachment=function(a,t){var i=e(this);i.on("click",function(n){if(n.preventDefault(),window.cacie_edit_enabled){var c=i.cacie_get_value(a,t);e.isArray(c)||(c=[c]);var l={multiple:void 0!==a.editable.multiple&&a.editable.multiple,title:ACP_Editing.i18n.media};void 0!==a.editable.attachment&&void 0!==a.editable.attachment.library&&(l.library={},void 0!==a.editable.attachment.library.uploaded_to_post&&(l.library.uploadedTo=t.ID),void 0!==a.editable.attachment.library.type&&(l.library.type=a.editable.attachment.library.type),"image"===a.editable.attachment.library.type&&(l.title=ACP_Editing.i18n.image),"audio"===a.editable.attachment.library.type&&(l.title=ACP_Editing.i18n.audio)),"js"in a.editable&&(l=e.extend(l,a.editable.js));var d=wp.media(l);d.on("open",function(){var e=d.state().get("selection");c.forEach(function(a){attachment=wp.media.attachment(a),attachment.fetch(),e.add(attachment?[attachment]:[])})}),d.on("select",function(){var e=d.state().get("selection").toJSON(),n=d.options.multiple,c=[];for(var l in e)if(e.hasOwnProperty(l)){var o=e[l];c.push(o.id)}1!==c.length||n||(c=c[0]),i.cacie_savecolumn(a,t,c)}),void 0!==a.editable.attachment&&void 0!==a.editable.attachment.disable_select_current&&a.editable.attachment.disable_select_current&&d.on("ready",function(){setTimeout(function(){},1)}),d.open()}})},e.fn.cacie_edit_date=function(a,t){var i=e(this),n=i.cacie_get_value(a,t);n&&(n=[n.slice(0,4),"-",n.slice(4)].join(""),n=[n.slice(0,7),"-",n.slice(7)].join("")),i.attr("data-date",n),i.attr("data-date-format","yyyy-mm-dd"),i.bdatepicker({weekStart:1}).on("changeDate",function(e){var n=new Date(e.date),c=n.yyyymmdd();i.cacie_savecolumn(a,t,c),i.bdatepicker("hide")}),Date.prototype.yyyymmdd=function(){var e=this.getFullYear().toString(),a=(this.getMonth()+1).toString(),t=this.getDate().toString();return e+(a[1]?a:"0"+a[0])+(t[1]?t:"0"+t[0])}},e.fn.cacie_edit_checklist=function(a,t){var i=e(this),n=i.cacie_get_value(a,t),c=a.editable.options;"false"==n&&(n=""),i.cacie_xeditable({type:"checklist",value:n,source:cacie_options_format_editable(c)},a,t)},e.fn.cacie_xeditable=function(a,t,i){var n=e(this),c={url:ajaxurl,params:{action:"acp_editing_column_save",list_screen:AC.list_screen,layout:AC.layout,pk:i.ID,column:t.column_name,_ajax_nonce:AC.ajax_nonce},pk:i.ID,value:e(this).cacie_get_value(t,i),placement:"bottom",mode:"popup",emptytext:""};a=e.extend(c,a),void 0!==t.editable.js&&(a=e.extend(a,t.editable.js)),void 0!==t.editable.placeholder&&(a.placeholder=t.editable.placeholder);var l=[];if(void 0!==t.editable.maxlength&&l.push({key:"maxlength",value:parseInt(t.editable.maxlength,10)}),void 0!==t.editable.range_min&&l.push({key:"min",value:parseFloat(t.editable.range_min,10)}),void 0!==t.editable.range_max&&l.push({key:"max",value:parseFloat(t.editable.range_max,10)}),void 0!==t.editable.range_step){var d="any";t.editable.range_step.length>0&&"any"!=t.editable.range_step&&(d=parseFloat(t.editable.range_step,10)),l.push({key:"step",value:d})}if(l.length){var o="";for(var r in l)o+=l[r].key+'="'+e("<div />").text(l[r].value).html()+'"';switch(t.editable.type){case"number":a.tpl='<input type="number" '+o+">";break;case"text":a.tpl='<input type="text" '+o+">";break;case"textarea":a.tpl="<textarea "+o+"></textarea>"}}void 0!==t.editable.required&&t.editable.required&&(a.validate=function(e){var a=!0;switch(t.editable.type){case"select":e&&"null"!=e||(a=!1);break;default:e.length||(a=!1)}if(!a)return ACP_Editing.i18n.errors.field_required}),n.cacie_get_target(t).on("save",function(e,a){n.cacie_store_revision(t,i,a.newValue),n.cacie_after_save(t,i,a.newValue)}),void 0===t.editable.display_ajax||t.editable.display_ajax?(a.display=function(){},a.success=function(e){if(e.success&&n.cacie_replace_column_html(e.data,t.column_name),n.cacie_after_save(t,i),void 0!==e.data&&void 0!==e.data.rawvalue)return{newValue:e.data.rawvalue}}):void 0!==t.editable.js&&void 0!==t.editable.js.selector?a.success=function(){n.cacie_after_save(t,i)}:a.success=function(e){if(n.cacie_after_save(t,i),void 0!==e.data&&void 0!==e.data.rawvalue)return{newValue:e.data.rawvalue}},t.editable.is_xeditable=!0;var s=n;void 0!==t.editable.js&&void 0!==t.editable.js.selector&&(s=n.find(t.editable.js.selector),n.removeClass("cacie-editable"),s.addClass("cacie-editable")),window.xeditables.push(s),n.editable(a)},e.fn.cacie_store_revision=function(a,t,i){for(var n=ACP_Editing_Items[t.ID].columndata[a.column_name].revisions,c=ACP_Editing_Items[t.ID].columndata[a.column_name].current_revision,l=n.length-c-1,d=0;d<l;d++)ACP_Editing_Items[t.ID].columndata[a.column_name].revisions.pop();ACP_Editing_Items[t.ID].columndata[a.column_name].revisions.push(i),ACP_Editing_Items[t.ID].columndata[a.column_name].current_revision++,e(this).cacie_handle_actions(a,t)},e.fn.cacie_handle_actions=function(a,t){var i,n,c,l,d,o,r;switch(i=e(this),n=i.parent().find(".cacie-cell-actions"),i.cacie_wrap_images(),n.remove(),i.parent().find(".cacie-edit, .cacie-undo, .cacie-redo, .cacie-clear").remove(),n=e('<div class="cacie-cell-actions" />'),r=e('<a href="#" class="cacie-cell-action cacie-edit" title="'+ACP_Editing.i18n.edit+'" />'),c=e('<a href="#" class="cacie-cell-action cacie-undo" title="'+ACP_Editing.i18n.undo+'" />'),l=e('<a href="#" class="cacie-cell-action cacie-redo" title="'+ACP_Editing.i18n.redo+'" />'),d=e('<a href="#" class="cacie-cell-action cacie-clear" title="'+ACP_Editing.i18n.delete+'"/>'),c.hide(),l.hide(),d.hide(),n.append(l),n.append(c),a.editable.clear_button&&n.prepend(d),a.type){case"title":case"name":case"username":case"coupon_code":n.prepend(r),i.parents("td").find(a.editable.js.selector).after(n);break;default:switch(a.editable.type){case"attachment":i.find("> a").length>0&&(o=e('<a href="'+i.find("a").attr("href")+'" class="cacie-cell-action cacie-download" target="_blank" title="'+ACP_Editing.i18n.download+'"/>'),n.prepend(o)),n.prepend(r),i.parents("td").find(".cacie-editable").after(n);break;case"media":n.prepend(r),c.before('<div class="cacie-separator" />'),l.before('<div class="cacie-separator" />'),void 0!==a.editable.multiple&&a.editable.multiple?(i.parents("td").addClass("cacie-multiple"),d.remove(),i.parents("td").find(".cacie-item").each(function(){var n=e('<div class="cacie-item-actions" />'),c=e('<a href="#" class="cacie-cell-action cacie-delete" title="'+ACP_Editing.i18n.delete+'"/>');n.append(c),c.on("click",function(a,t){return function(){var n=e(this).parents(".cacie-item"),c=i.cacie_get_value(a,t);return e.isArray(c)&&(c=e.grep(c,function(e){return e!=n.attr("data-cacie-id")})),n.fadeOut(1e3),i.cacie_savecolumn(a,t,c),!1}}(a,t)),e(this).append(n)}),i.parents("td").find(".cacie-editable").append(n)):i.parents("td").find(".cacie-editable").append(n);break;default:n.prepend(r),i.parents("td").find(".cacie-editable").after(n)}}r.on("click",function(e){return function(a){a.preventDefault(),a.stopPropagation(),i.cacie_get_target(e).trigger("click")}}(a)),c.on("click",function(e,a){return function(t){t.preventDefault(),t.stopPropagation(),i.cacie_restore_revision(e,a,a.columndata[e.column_name].current_revision-1)}}(a,t)),l.on("click",function(e,a){return function(t){t.preventDefault(),t.stopPropagation(),i.cacie_restore_revision(e,a,a.columndata[e.column_name].current_revision+1)}}(a,t)),d.on("click",function(e,a){return function(t){i.cacie_savecolumn(e,a,""),t.stopPropagation()}}(a,t));var s=ACP_Editing_Items[t.ID].columndata[a.column_name].revisions,_=ACP_Editing_Items[t.ID].columndata[a.column_name].current_revision,u=s[_];_<s.length-1?l.show():l.hide(),_>0?c.show():c.hide(),u?d.show():d.hide()},e.fn.cacie_savecolumn=function(a,t,i,n){var c=e(this);c.cacie_set_value(a,t,i),c.closest("td").addClass("processing"),n=void 0===n||n,n&&e(this).cacie_store_revision(a,t,i),c.cacie_add_ajax_loading(a),e.post(ajaxurl,{action:"acp_editing_column_save",list_screen:AC.list_screen,layout:AC.layout,column:a.column_name,pk:t.ID,value:i,_ajax_nonce:AC.ajax_nonce},function(e){e.success&&c.cacie_replace_column_html(e.data,a.column_name),c.cacie_after_save(a,t)},"json")},e.fn.cacie_replace_column_html=function(a,t){var i=e(this),n=!1,c=i.find(".row-actions");a.cell_html?n=a.cell_html:a.row_html&&(c="",n=e(a.row_html).find("td."+t).html());var l=e("<div>").html(n);i.html(l.append(c).html())}}(jQuery),function(e){"use strict";var a=function(e){this.init("color",e,a.defaults)};e.fn.editableutils.inherit(a,e.fn.editabletypes.abstractinput),e.extend(a.prototype,{render:function(){},value2input:function(e){this.$input.find("input").val(e).wpColorPicker()},input2value:function(){return this.$input.find(".wp-color-picker").val()}});var t="";t+='<div class="single-input">',t+='<input type="text" name="ac_input_text">',t+="</div>",a.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:t}),e.fn.editabletypes.color=a}(window.jQuery),jQuery.fn.cacie_edit_color=function(e,a){var t=jQuery(this);t.cacie_xeditable({type:"color",inputclass:e.editable.subtype,value:t.cacie_get_value(e,a)},e,a)};