jQuery(document).ready(function(e){var t=e(".ac-admin");if(t.length){var a=t.find(".sidebox.layouts");a.hasClass("events-binded")||(a.addClass("events-binded"),a.find("a.add-new").click(function(t){t.preventDefault(),e(this).toggleClass("open").closest(".layouts").find(".new").slideToggle()}),a.find(".new form").on("submit",function(t){if(t.preventDefault(),$name=e(this).find(".row.name"),!$name.find("input").val())return void $name.addClass("save-error");e(this).unbind("submit").submit()}),a.find("select.roles").each(function(){e(this).select2({placeholder:acp_layouts.roles}).on("select2:select",function(t){e(this).select2("open")}).on("select2:open",function(t){setTimeout(function(){e(".select2-container.select2-container--open .select2-dropdown li[role=group]").each(function(){e(this).find("li[aria-selected=false]").length>0?e(this).show():e(this).hide()})},1)})}),a.find(".layout .head").click(function(t){t.preventDefault(),e(this).closest(".layout").toggleClass("open").find(".body").slideToggle(200)}),a.find(".layout .head a, .layout .head input").click(function(e){e.stopPropagation()}),a.find("input.name").bind("keyup change",function(){var t=e(this).val(),a=e(this).closest(".layout").data("screen");t.trim()||(t=e(this).data("value")),e(this).closest(".ac-admin").find('.layout-selector li[data-screen="'+a+'"] a').text(t);e(this).closest(".layout").find(".head .title").text(t)}),a.find(".layout").each(function(t){var a=e(this).closest(".layouts").data("type"),n=e(this).data("screen");e(this).ac_update_layout(a,n)}),a.find("select.users").select2({placeholder:acp_layouts.users,multiple:!0,minimumInputLength:1,ajax:{type:"POST",url:ajaxurl,dataType:"json",delay:350,data:function(e){return{action:"acp_layout_get_users",_ajax_nonce:acp_layouts._nonce,search:e.term}},processResults:function(e){return e&&e.success&&e.data?{results:e.data}:{results:[]}},cache:!0}}),e(document).bind("cac_update",function(t,a){e(a).find(".layout input.save").trigger("click")}))}}),jQuery.fn.ac_update_layout=function(e,t){var a=jQuery(this),n=a.find(".save");n.click(function(t){t.preventDefault(),a.addClass("loading");var n=a.find("input.name"),s=jQuery(this).attr("disabled","disabled");a.find(".row.name").removeClass("save-error"),jQuery.post(ajaxurl,{action:"acp_update_layout",_ajax_nonce:acp_layouts._nonce,list_screen:e,data:a.find("form").serialize()},function(e){e&&(e.success?(n.data("value",n.val()),a.find(".save-message").slideDown().delay(1e3).slideUp(),a.find(".title-div span.description").text(e.data.title_description)):e.data&&"empty-name"===e.data&&a.addClass("open").find(".body").slideDown().find(".row.name").addClass("save-error"))},"json").fail(function(e){}).always(function(){s.removeAttr("disabled"),a.removeClass("loading")})}),a.find("input").keypress(function(e){13===e.which&&n.trigger("click")})};