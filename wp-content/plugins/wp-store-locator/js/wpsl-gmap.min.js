jQuery(document).ready(function(a){function u(f,g){var h,i,j,k,l,m,n;i=x(g),n=Number(i.zoomLevel),j=z(),b=new google.maps.Geocoder,d=new google.maps.DirectionsRenderer,e=new google.maps.DirectionsService,h={zoom:Number(i.zoomLevel),center:i.startLatLng,mapTypeId:google.maps.MapTypeId[i.mapType.toUpperCase()],mapTypeControl:!!Number(i.mapTypeControl),scrollwheel:!!Number(i.scrollWheel),streetViewControl:!!Number(i.streetView),gestureHandling:i.gestureHandling,zoomControlOptions:{position:google.maps.ControlPosition[i.controlPosition.toUpperCase()+"_TOP"]}},o=A(),c=new google.maps.Map(document.getElementById(f),h),B(i.mapStyle),void 0!==window["wpslMap_"+g]&&void 0!==window["wpslMap_"+g].locations&&(l=new google.maps.LatLngBounds,m=window["wpslMap_"+g].locations,a.each(m,function(a){k=new google.maps.LatLng(m[a].lat,m[a].lng),ca(k,m[a].id,m[a],!1,j),l.extend(k)}),c.fitBounds(l),google.maps.event.addListenerOnce(c,"bounds_changed",function(a){return function(){a.getZoom()>n&&a.setZoom(n)}}(c))),a("#wpsl-gmap").length&&(1==wpslSettings.autoComplete&&v(),!E()&&a(".wpsl-dropdown").length&&1==wpslSettings.enableStyledDropdowns?va():(a("#wpsl-search-wrap select").show(),E()?a("#wpsl-wrap").addClass("wpsl-mobile"):a("#wpsl-wrap").addClass("wpsl-default-filters")),a(".wpsl-search").hasClass("wpsl-widget")||(1==wpslSettings.autoLocate?F(i.startLatLng,j):1==wpslSettings.autoLoad&&D(i.startLatLng,j)),1!=wpslSettings.mouseFocus||E()||a("#wpsl-search-input").focus(),I(j),K(i,c,j),Ba()),w()}function v(){var b,c,d,e={};void 0===wpslSettings.geocodeComponents||a.isEmptyObject(wpslSettings.geocodeComponents)||(e.componentRestrictions=wpslSettings.geocodeComponents),b=document.getElementById("wpsl-search-input"),c=new google.maps.places.Autocomplete(b,e),c.addListener("place_changed",function(){d=c.getPlace(),d.geometry&&(g=d.geometry.location)})}function w(){void 0!==wpslSettings.markerZoomTo&&1==wpslSettings.markerZoomTo&&google.maps.event.addListener(c,"zoom_changed",function(){la()})}function x(a){var b,c,d,e=["zoomLevel","mapType","mapTypeControl","mapStyle","streetView","scrollWheel","controlPosition"],f={zoomLevel:wpslSettings.zoomLevel,mapType:wpslSettings.mapType,mapTypeControl:wpslSettings.mapTypeControl,mapStyle:wpslSettings.mapStyle,streetView:wpslSettings.streetView,scrollWheel:wpslSettings.scrollWheel,controlPosition:wpslSettings.controlPosition,gestureHandling:wpslSettings.gestureHandling};if(void 0!==window["wpslMap_"+a]&&void 0!==window["wpslMap_"+a].shortCode)for(b=0,c=e.length;b<c;b++)void 0!==(d=window["wpslMap_"+a].shortCode[e[b]])&&(f[e[b]]=d);return f.startLatLng=y(a),f}function y(a){var b,c,d="";return void 0!==window["wpslMap_"+a]&&void 0!==window["wpslMap_"+a].locations&&(d=window["wpslMap_"+a].locations[0]),void 0!==d&&void 0!==d.lat&&void 0!==d.lng?b=new google.maps.LatLng(d.lat,d.lng):""!==wpslSettings.startLatlng?(c=wpslSettings.startLatlng.split(","),b=new google.maps.LatLng(c[0],c[1])):b=new google.maps.LatLng(0,0),b}function z(){var a,b,c={};return void 0!==wpslSettings.infoWindowStyle&&"infobox"==wpslSettings.infoWindowStyle?(a=wpslSettings.infoBoxClearance.split(","),b=wpslSettings.infoBoxPixelOffset.split(","),c={alignBottom:!0,boxClass:wpslSettings.infoBoxClass,closeBoxMargin:wpslSettings.infoBoxCloseMargin,closeBoxURL:wpslSettings.infoBoxCloseUrl,content:"",disableAutoPan:!!Number(wpslSettings.infoBoxDisableAutoPan),enableEventPropagation:!!Number(wpslSettings.infoBoxEnableEventPropagation),infoBoxClearance:new google.maps.Size(Number(a[0]),Number(a[1])),pixelOffset:new google.maps.Size(Number(b[0]),Number(b[1])),zIndex:Number(wpslSettings.infoBoxZindex)},i=new InfoBox(c)):i=new google.maps.InfoWindow,i}function A(){var a,b=wpslSettings.markerIconProps,c={};void 0!==b.url?c.url=b.url:void 0!==b.categoryMarkerUrl?c.categoryMarkerUrl=b.categoryMarkerUrl:void 0!==b.alternateMarkerUrl?c.alternateMarkerUrl=b.alternateMarkerUrl:c.url=wpslSettings.url+"img/markers/";for(var d in b)b.hasOwnProperty(d)&&(a=b[d].split(","),2==a.length&&(c[d]=a));return c}function B(a){(a=C(a))&&c.setOptions({styles:a})}function C(a){try{var b=JSON.parse(a);if(b&&"object"==typeof b&&null!==b)return b}catch(a){}return!1}function D(a,b){ca(a,0,"",!0,b),V(a,r,t,b)}function E(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function F(b,c){if(navigator.geolocation){var d,e,g=Number(wpslSettings.geoLocationTimout);d=setInterval(function(){a(".wpsl-icon-direction").toggleClass("wpsl-active-icon")},600),e=setTimeout(function(){G(d),D(b,c)},g),navigator.geolocation.getCurrentPosition(function(g){G(d),clearTimeout(e),sa(!1),H(b,g,r,c),a(".wpsl-search").addClass("wpsl-geolocation-run")},function(d){if(a(".wpsl-icon-direction").hasClass("wpsl-user-activated")&&!a(".wpsl-search").hasClass("wpsl-geolocation-run")){switch(d.code){case d.PERMISSION_DENIED:alert(wpslGeolocationErrors.denied);break;case d.POSITION_UNAVAILABLE:alert(wpslGeolocationErrors.unavailable);break;case d.TIMEOUT:alert(wpslGeolocationErrors.timeout);break;default:alert(wpslGeolocationErrors.generalError)}a(".wpsl-icon-direction").removeClass("wpsl-active-icon")}else a(".wpsl-search").hasClass("wpsl-geolocation-run")||(clearTimeout(e),D(b,c))},{maximumAge:6e4,timeout:g,enableHighAccuracy:!0})}else alert(wpslGeolocationErrors.unavailable),D(b,c)}function G(b){clearInterval(b),a(".wpsl-icon-direction").removeClass("wpsl-active-icon")}function H(a,b,d,e){if(void 0===b)D(a,e);else{var g=new google.maps.LatLng(b.coords.latitude,b.coords.longitude);f=b,T(g),c.setCenter(g),ca(g,0,"",!0,e),V(g,d,t,e)}}function I(b){a("#wpsl-search-btn").unbind("click").bind("click",function(c){return a("#wpsl-search-input").removeClass(),a("#wpsl-search-input").val()?(a("#wpsl-result-list ul").empty(),a("#wpsl-stores").show(),a(".wpsl-direction-before, .wpsl-direction-after").remove(),a("#wpsl-direction-details").hide(),r=!1,J(),sa(!1),M(),1==wpslSettings.autoComplete&&void 0!==g?S(g,b):R(b)):a("#wpsl-search-input").addClass("wpsl-error").focus(),!1})}function J(){void 0!==wpslSettings.infoWindowStyle&&"infobox"==wpslSettings.infoWindowStyle&&void 0!==m[0]&&m[0].close()}function K(b,c,d){google.maps.event.addListenerOnce(c,"tilesloaded",function(){a(".gm-style").append(wpslSettings.mapControls),a(".wpsl-icon-reset, #wpsl-reset-map").length>0&&(L(b.startLatLng,d),a(".wpsl-icon-reset").hide()),a(".wpsl-icon-direction").on("click",function(){a(this).addClass("wpsl-user-activated"),F(b.startLatLng,d)})})}function L(b,d){a(".wpsl-icon-reset, #wpsl-reset-map").on("click",function(){a(this).hasClass("wpsl-in-progress")||(1==wpslSettings.autoLoad&&(t=1),c.getCenter().lat()===q.centerLatlng.lat()&&c.getCenter().lng()===q.centerLatlng.lng()&&c.getZoom()===q.zoomLevel||(sa(!1),a("#wpsl-search-input").val("").removeClass(),a(".wpsl-icon-reset").addClass("wpsl-in-progress"),j&&j.clearMarkers(),M(),N(),1==wpslSettings.autoLocate?H(b,f,!0,d):D(b,d)),a("#wpsl-stores").show(),a("#wpsl-direction-details").hide())})}function M(){void 0!==k&&""!==k&&(k.setMap(null),k="")}function N(){var b,c,d,e,f,g,h,i,j=a("#wpsl-wrap").hasClass("wpsl-default-filters"),k=[wpslSettings.searchRadius+" "+wpslSettings.distanceUnit,wpslSettings.maxResults],l=["wpsl-radius","wpsl-results"];for(b=0,c=l.length;b<c;b++)a("#"+l[b]+" select").val(parseInt(k[b])),a("#"+l[b]+" li").removeClass(),"wpsl-radius"==l[b]?d=wpslSettings.searchRadius:"wpsl-results"==l[b]&&(d=wpslSettings.maxResults),a("#"+l[b]+" li").each(function(){a(this).text()===k[b]&&(a(this).addClass("wpsl-selected-dropdown"),a("#"+l[b]+" .wpsl-selected-item").html(k[b]).attr("data-value",d))});a("#wpsl-category").length&&(a("#wpsl-category select").val(0),a("#wpsl-category li").removeClass(),a("#wpsl-category li:first-child").addClass("wpsl-selected-dropdown"),e=a("#wpsl-category li:first-child").text(),a("#wpsl-category .wpsl-selected-item").html(e).attr("data-value",0)),a(".wpsl-custom-dropdown").length>0&&a(".wpsl-custom-dropdown").each(function(b){j?a(this).find("option").removeAttr("selected"):(f=a(this).siblings("div"),g=f.find("li:first-child"),h=g.text(),i=g.attr("data-value"),f.find("li").removeClass(),f.prev().html(h).attr("data-value",i))})}function O(b){var d,e,f,g,h;for(J(),h=b.parents("li").length>0?b.parents("li").data("store-id"):b.parents(".wpsl-info-window").data("store-id"),void 0!==k&&""!==k&&(e=k.getPosition()),p={centerLatlng:c.getCenter(),zoomLevel:c.getZoom()},d=0,g=n.length;d<g;d++)0!=n[d].storeId||void 0!==e&&""!==e?n[d].storeId==h&&(f=n[d].getPosition()):e=n[d].getPosition();e&&f?(a("#wpsl-direction-details ul").empty(),a(".wpsl-direction-before, .wpsl-direction-after").remove(),Q(e,f)):alert(wpslLabels.generalError)}function P(a,b){var c,d,e;for(c=0,d=n.length;c<d;c++)n[c].storeId==a&&(e=n[c],"start"==b?e.setAnimation(google.maps.Animation.BOUNCE):e.setAnimation(null))}function Q(b,f){var g,h,i,l,m,o,p,q,r,s="",t={};q="km"==wpslSettings.distanceUnit?"METRIC":"IMPERIAL",t={origin:b,destination:f,travelMode:wpslSettings.directionsTravelMode,unitSystem:google.maps.UnitSystem[q]},e.route(t,function(b,e){if(e==google.maps.DirectionsStatus.OK){if(d.setMap(c),d.setDirections(b),b.routes.length>0){for(m=b.routes[0],o=0;o<m.legs.length;o++)for(g=m.legs[o],p=0,h=g.steps.length;p<h;p++)i=g.steps[p],l=p+1,s=s+"<li><div class='wpsl-direction-index'>"+l+"</div><div class='wpsl-direction-txt'>"+i.instructions+"</div><div class='wpsl-direction-distance'>"+i.distance.text+"</div></li>";for(a("#wpsl-direction-details ul").append(s).before("<div class='wpsl-direction-before'><a class='wpsl-back' id='wpsl-direction-start' href='#'>"+wpslLabels.back+"</a><div><span class='wpsl-total-distance'>"+m.legs[0].distance.text+"</span> - <span class='wpsl-total-durations'>"+m.legs[0].duration.text+"</span></div></div>").after("<p class='wpsl-direction-after'>"+b.routes[0].copyrights+"</p>"),a("#wpsl-direction-details").show(),o=0,h=n.length;o<h;o++)n[o].setMap(null);j&&j.clearMarkers(),void 0!==k&&""!==k&&k.setMap(null),a("#wpsl-stores").hide(),1==wpslSettings.templateId&&(r=a("#wpsl-gmap").offset(),a(window).scrollTop(r.top))}}else ua(e)})}function R(c){var d,e={address:a("#wpsl-search-input").val()};void 0===wpslSettings.geocodeComponents||a.isEmptyObject(wpslSettings.geocodeComponents)||(e.componentRestrictions=wpslSettings.geocodeComponents),b.geocode(e,function(a,b){b==google.maps.GeocoderStatus.OK?(d=a[0].geometry.location,S(d,c)):ta(b)})}function S(a,b){ca(a,0,"",!0,b),V(a,r,!1,b)}function T(c){var d;b.geocode({latLng:c},function(b,c){c==google.maps.GeocoderStatus.OK?""!==(d=U(b))&&a("#wpsl-search-input").val(d):ta(c)})}function U(a){var b,c,d,e=a[0].address_components.length;for(d=0;d<e;d++)c=a[0].address_components[d].types,(/^postal_code$/.test(c)||/^postal_code_prefix,postal_code$/.test(c))&&(b=a[0].address_components[d].long_name);return b}function V(a,b,c,d){1==wpslSettings.directionRedirect?W(a,function(){X(a,b,c,d)}):X(a,b,c,d)}function W(a,c){b.geocode({latLng:a},function(a,b){b==google.maps.GeocoderStatus.OK?(l=a[0].formatted_address,c()):ta(b)})}function X(b,d,e,f){var g,h,i={},j="",l=a("#wpsl-listing-template").html(),m=a("#wpsl-stores ul"),n=wpslSettings.url+"img/ajax-loader.gif";i=Y(b,d,e),m.empty().append("<li class='wpsl-preloader'><img src='"+n+"'/>"+wpslLabels.preloader+"</li>"),a.get(wpslSettings.ajaxurl,i,function(d){a(".wpsl-preloader, .no-results").remove(),d.length>0?(a.each(d,function(a){_.extend(d[a],pa),g=new google.maps.LatLng(d[a].lat,d[a].lng),ca(g,d[a].id,d[a],!1,f),j+=_.template(l)(d[a])}),a("#wpsl-result-list").off("click",".wpsl-directions"),m.empty(),m.append(j),a("#wpsl-result-list").on("click",".wpsl-directions",function(){if(1!=wpslSettings.directionRedirect)return O(a(this)),!1}),ba(),a("#wpsl-result-list p:empty").remove()):(ca(b,0,"",!0,f),h=$(),m.html("<li class='no-results'>"+h+"</li>")),ra(),1==wpslSettings.resetMap&&(a.isEmptyObject(q)&&google.maps.event.addListenerOnce(c,"tilesloaded",function(){q={centerLatlng:c.getCenter(),zoomLevel:c.getZoom()},a("#wpsl-map-controls").addClass("wpsl-reset-exists"),a(".wpsl-icon-reset, #wpsl-reset-map").show()}),a(".wpsl-icon-reset").removeClass("wpsl-in-progress"))}),1!=wpslSettings.mouseFocus||E()||a("#wpsl-search-input").focus()}function Y(b,c,d){var e,g,h,i,j,l="",m=a("#wpsl-wrap").hasClass("wpsl-mobile"),n=a("#wpsl-wrap").hasClass("wpsl-default-filters"),o={action:"store_search",lat:b.lat(),lng:b.lng()};return c?(o.max_results=wpslSettings.maxResults,o.radius=wpslSettings.searchRadius):(m||n?(e=parseInt(a("#wpsl-results .wpsl-dropdown").val()),g=parseInt(a("#wpsl-radius .wpsl-dropdown").val())):(e=parseInt(a("#wpsl-results .wpsl-selected-item").attr("data-value")),g=parseInt(a("#wpsl-radius .wpsl-selected-item").attr("data-value"))),isNaN(e)?o.max_results=wpslSettings.maxResults:o.max_results=e,isNaN(g)?o.radius=wpslSettings.searchRadius:o.radius=g,void 0!==wpslSettings.categoryIds?o.filter=wpslSettings.categoryIds:a("#wpsl-category").length>0?(l=m||n?parseInt(a("#wpsl-category .wpsl-dropdown").val()):parseInt(a("#wpsl-category .wpsl-selected-item").attr("data-value")),isNaN(l)||0===l||(o.filter=l)):a("#wpsl-checkbox-filter").length>0&&a("#wpsl-checkbox-filter input:checked").length>0&&(o.filter=aa()),a(".wpsl-custom-dropdown").length>0&&a(".wpsl-custom-dropdown").each(function(b){h="",i="",m||n?(h=a(this).attr("name"),i=a(this).val()):(h=a(this).attr("name"),i=a(this).next(".wpsl-selected-item").attr("data-value")),h&&i&&(o[h]=i)}),a(".wpsl-custom-checkboxes").length>0&&a(".wpsl-custom-checkboxes").each(function(b){(j=a(this).attr("data-name"))&&(o[j]=Z(j))})),1==d&&(void 0!==f?o.skip_cache=1:(o.autoload=1,void 0!==wpslSettings.categoryIds&&(o.filter=wpslSettings.categoryIds))),void 0!==wpslSettings.collectStatistics&&0==d&&(o.search=a("#wpsl-search-input").val()),o}function Z(b){var c=a("[data-name="+b+"]"),d=[];return a(c).find("input:checked").each(function(b){d.push(a(this).val())}),d.join()}function $(){return void 0!==wpslSettings.noResults&&""!==wpslSettings.noResults?wpslSettings.noResults:wpslLabels.noResults}function aa(){var b=a("#wpsl-checkbox-filter input:checked").map(function(){return a(this).val()});return b=b.get(),b=b.join(",")}function ba(){if(1==wpslSettings.markerClusters){var a=Number(wpslSettings.clusterZoom),b=Number(wpslSettings.clusterSize);isNaN(a)&&(a=""),isNaN(b)&&(b=""),j=new MarkerClusterer(c,n,{gridSize:b,maxZoom:a})}}function ca(a,b,d,e,f){var g,h,i;0===b?(d={store:wpslLabels.startPoint},g=o.url+wpslSettings.startMarker):g=void 0!==d.alternateMarkerUrl&&d.alternateMarkerUrl?d.alternateMarkerUrl:void 0!==d.categoryMarkerUrl&&d.categoryMarkerUrl?d.categoryMarkerUrl:o.url+wpslSettings.storeMarker,h={url:g,scaledSize:new google.maps.Size(Number(o.scaledSize[0]),Number(o.scaledSize[1])),origin:new google.maps.Point(Number(o.origin[0]),Number(o.origin[1])),anchor:new google.maps.Point(Number(o.anchor[0]),Number(o.anchor[1]))},i=new google.maps.Marker({position:a,map:c,optimized:!1,title:da(d.store),draggable:e,storeId:b,icon:h}),n.push(i),google.maps.event.addListener(i,"click",function(c){return function(){0!=b?void 0!==wpslSettings.markerStreetView&&1==wpslSettings.markerStreetView?oa(a,function(){ja(i,qa(d),f,c)}):ja(i,qa(d),f,c):ja(i,wpslLabels.startPoint,f,c),google.maps.event.clearListeners(f,"domready"),google.maps.event.addListener(f,"domready",function(){ka(i,c),la()})}}(c)),e&&google.maps.event.addListener(i,"dragend",function(a){sa(!0),c.setCenter(a.latLng),T(a.latLng),V(a.latLng,r,t=!1,f)})}function da(a){if(a)return a.replace(/&#(\d+);/g,function(a,b){return String.fromCharCode(b)})}function ja(a,b,c,d){m.length=0,c.setContent(b),c.open(d,a),m.push(c),void 0!==wpslSettings.infoWindowStyle&&"infobox"==wpslSettings.infoWindowStyle&&1==wpslSettings.markerClusters&&(h=a.storeId,c.setVisible(!0))}function ka(b,c){a(".wpsl-info-actions a").on("click",function(d){var e=Number(wpslSettings.autoZoomLevel);if(d.stopImmediatePropagation(),a(this).hasClass("wpsl-directions")){if(1==wpslSettings.directionRedirect)return!0;O(a(this))}else a(this).hasClass("wpsl-streetview")?ma(b,c):a(this).hasClass("wpsl-zoom-here")&&(c.setCenter(b.getPosition()),c.setZoom(e));return!1})}function la(){c.getZoom()>=wpslSettings.autoZoomLevel?a(".wpsl-zoom-here").hide():a(".wpsl-zoom-here").show()}function ma(b,c){var d=c.getStreetView();d.setPosition(b.getPosition()),d.setVisible(!0),a("#wpsl-map-controls").hide(),na(d,c)}function na(b,c){google.maps.event.addListener(b,"visible_changed",function(){if(!b.getVisible()){var d=c.getZoom();a("#wpsl-map-controls").show(),c.setZoom(d-1),c.setZoom(d)}})}function oa(a,b){(new google.maps.StreetViewService).getPanoramaByLocation(a,50,function(a,c){s=c==google.maps.StreetViewStatus.OK,b()})}function qa(b){var d;return d=a("#wpsl-base-gmap_0").length?a("#wpsl-cpt-info-window-template").html():a("#wpsl-info-window-template").html(),_.template(d)(b)}function ra(){var a,b,d=Number(wpslSettings.autoZoomLevel),e=new google.maps.LatLngBounds;for(google.maps.event.addListenerOnce(c,"bounds_changed",function(a){this.getZoom()>d&&this.setZoom(d)}),a=0,b=n.length;a<b;a++)e.extend(n[a].position);c.fitBounds(e)}function sa(a){var b,c;if(d.setMap(null),n){for(c=0,b=n.length;c<b;c++)a?1!=n[c].draggable?n[c].setMap(null):k=n[c]:n[c].setMap(null);n.length=0}j&&j.clearMarkers()}function ta(a){var b;switch(a){case"ZERO_RESULTS":b=wpslLabels.noResults;break;case"OVER_QUERY_LIMIT":b=wpslLabels.queryLimit;break;default:b=wpslLabels.generalError}alert(b)}function ua(a){var b;switch(a){case"NOT_FOUND":case"ZERO_RESULTS":b=wpslLabels.noDirectionsFound;break;case"OVER_QUERY_LIMIT":b=wpslLabels.queryLimit;break;default:b=wpslLabels.generalError}alert(b)}function va(){var b=Number(wpslSettings.maxDropdownHeight);a(".wpsl-dropdown").each(function(c){var d,e,f=a(this);f.$dropdownWrap=f.wrap("<div class='wpsl-dropdown'></div>").parent(),f.$selectedVal=f.val(),f.$dropdownElem=a("<div><ul/></div>").appendTo(f.$dropdownWrap),f.$dropdown=f.$dropdownElem.find("ul"),f.$options=f.$dropdownWrap.find("option"),f.hide().removeClass("wpsl-dropdown"),a.each(f.$options,function(){d=a(this).val()==f.$selectedVal?'class="wpsl-selected-dropdown"':"",f.$dropdown.append("<li data-value="+a(this).val()+" "+d+">"+a(this).text()+"</li>")}),f.$dropdownElem.before("<span data-value="+f.find(":selected").val()+" class='wpsl-selected-item'>"+f.find(":selected").text()+"</span>"),f.$dropdownItem=f.$dropdownElem.find("li"),f.$dropdownWrap.on("click",function(c){if(a(this).hasClass("wpsl-active"))return void a(this).removeClass("wpsl-active");wa(),a(this).toggleClass("wpsl-active"),e=0,a(this).hasClass("wpsl-active")?(f.$dropdownItem.each(function(b){e+=a(this).outerHeight()}),f.$dropdownElem.css("height",e+2+"px")):f.$dropdownElem.css("height",0),e>b&&(a(this).addClass("wpsl-scroll-required"),f.$dropdownElem.css("height",b+"px")),c.stopPropagation()}),f.$dropdownItem.on("click",function(b){f.$dropdownWrap.find(a(".wpsl-selected-item")).html(a(this).text()).attr("data-value",a(this).attr("data-value")),f.$dropdownItem.removeClass("wpsl-selected-dropdown"),a(this).addClass("wpsl-selected-dropdown"),wa(),b.stopPropagation()})}),a(document).click(function(){wa()})}function wa(){a(".wpsl-dropdown").removeClass("wpsl-active"),a(".wpsl-dropdown div").css("height",0)}function Ba(){a(".wpsl-search").hasClass("wpsl-widget")&&(a("#wpsl-search-btn").trigger("click"),a(".wpsl-search").removeClass("wpsl-widget"))}var b,c,d,e,f,g,h,i,j,k,l,m=[],n=[],o={},p={},q={},r=!1,s=!1,t="undefined"!=typeof wpslSettings?wpslSettings.autoLoad:"";if(_.templateSettings={evaluate:/\<\%(.+?)\%\>/g,interpolate:/\<\%=(.+?)\%\>/g,escape:/\<\%-(.+?)\%\>/g},a(".wpsl-gmap-canvas").length&&(a("<img />").attr("src",wpslSettings.url+"img/ajax-loader.gif"),a(".wpsl-gmap-canvas").each(function(b){u(a(this).attr("id"),b)})),a("#wpsl-result-list").on("click",".wpsl-back",function(){var b,e;for(d.setMap(null),b=0,e=n.length;b<e;b++)n[b].setMap(c);return void 0!==k&&""!==k&&k.setMap(c),j&&ba(),c.setCenter(p.centerLatlng),c.setZoom(p.zoomLevel),a(".wpsl-direction-before, .wpsl-direction-after").remove(),a("#wpsl-stores").show(),a("#wpsl-direction-details").hide(),!1}),a("#wpsl-gmap").length&&("bounce"==wpslSettings.markerEffect?(a("#wpsl-stores").on("mouseenter","li",function(){P(a(this).data("store-id"),"start")}),a("#wpsl-stores").on("mouseleave","li",function(){P(a(this).data("store-id"),"stop")})):"info_window"==wpslSettings.markerEffect&&a("#wpsl-stores").on("mouseenter","li",function(){var b,d;for(b=0,d=n.length;b<d;b++)n[b].storeId==a(this).data("store-id")&&(google.maps.event.trigger(n[b],"click"),c.setCenter(n[b].position))})),void 0!==wpslSettings.infoWindowStyle&&"infobox"==wpslSettings.infoWindowStyle&&1==wpslSettings.markerClusters){var ea,fa,ga,ha,ia;google.maps.event.addListener(c,"zoom_changed",function(){google.maps.event.addListenerOnce(c,"idle",function(){if(void 0!==j&&(ea=j.clusters_,ea.length))for(ha=0,fa=ea.length;ha<fa;ha++)for(ia=0,ga=ea[ha].markers_.length;ia<ga;ia++)if(ea[ha].markers_[ia].storeId==h){i.getVisible()&&null===ea[ha].markers_[ia].map?i.setVisible(!1):i.getVisible()||null===ea[ha].markers_[ia].map||i.setVisible(!0);break}})})}var pa={formatPhoneNumber:function(a){return 1==wpslSettings.phoneUrl&&E()&&(a="<a href='tel:"+pa.formatClickablePhoneNumber(a)+"'>"+a+"</a>"),a},formatClickablePhoneNumber:function(a){return-1!=a.indexOf("+")&&-1!=a.indexOf("(0)")&&(a=a.replace("(0)","")),a.replace(/(-| |\(|\)|\.|)/g,"")},createInfoWindowActions:function(b){var c,d="",e="";return a("#wpsl-gmap").length&&(s&&(d="<a class='wpsl-streetview' href='#'>"+wpslLabels.streetView+"</a>"),1==wpslSettings.markerZoomTo&&(e="<a class='wpsl-zoom-here' href='#'>"+wpslLabels.zoomHere+"</a>"),c="<div class='wpsl-info-actions'>"+pa.createDirectionUrl(b)+d+e+"</div>"),c},createDirectionUrl:function(b){var d,e,f={};return 1==wpslSettings.directionRedirect?(void 0===l&&(l=""),f.target="target='_blank'",void 0!==b?f.src=a("[data-store-id="+b+"] .wpsl-directions").attr("href"):(e=this.zip?this.zip+", ":"",d=this.address+", "+this.city+", "+e+this.country,f.src="https://maps.google.com/maps?saddr="+pa.rfc3986EncodeURIComponent(l)+"&daddr="+pa.rfc3986EncodeURIComponent(d))):f={src:"#",target:""},"<a class='wpsl-directions' "+f.target+" href='"+f.src+"'>"+wpslLabels.directions+"</a>"},rfc3986EncodeURIComponent:function(a){return encodeURIComponent(a).replace(/[!'()*]/g,escape)}};if(a("#wpsl-stores").on("click",".wpsl-store-details",function(){var b,c,d=a(this).parents("li"),e=d.data("store-id");if("info window"==wpslSettings.moreInfoLocation)for(b=0,c=n.length;b<c;b++)n[b].storeId==e&&google.maps.event.trigger(n[b],"click");else d.find(".wpsl-more-info-listings").is(":visible")?a(this).removeClass("wpsl-active-details"):a(this).addClass("wpsl-active-details"),d.siblings().find(".wpsl-store-details").removeClass("wpsl-active-details"),d.siblings().find(".wpsl-more-info-listings").hide(),d.find(".wpsl-more-info-listings").toggle();if("default"!=wpslSettings.templateId||"store listings"==wpslSettings.moreInfoLocation)return!1}),a("a[href='#"+wpslSettings.mapTabAnchor+"']").length){var xa,ya,za=!!Number(wpslSettings.mapTabAnchorReturn);a("a[href='#"+wpslSettings.mapTabAnchor+"']").on("click",function(){return setTimeout(function(){xa=c.getZoom(),ya=c.getCenter(),google.maps.event.trigger(c,"resize"),c.setZoom(xa),c.setCenter(ya),ra()},50),za})}});