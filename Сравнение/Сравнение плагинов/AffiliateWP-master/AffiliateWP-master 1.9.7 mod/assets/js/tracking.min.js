jQuery(document).ready(function($){function affwp_track_visit(affiliate_id,url_campaign){$.cookie("affwp_ref",affiliate_id,{expires:AFFWP.expiration,path:"/"}),$.ajax({type:"POST",data:{action:"affwp_track_visit",affiliate:affiliate_id,campaign:url_campaign,url:document.URL,referrer:document.referrer},url:affwp_scripts.ajaxurl,success:function(response){$.cookie("affwp_ref_visit_id",response,{expires:AFFWP.expiration,path:"/"}),$.cookie("affwp_campaign",url_campaign,{expires:AFFWP.expiration,path:"/"})}}).fail(function(response){window.console&&window.console.log&&console.log(response)})}function affwp_get_query_vars(){for(var hash,vars=[],hashes=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<hashes.length;i++){hash=hashes[i].split("="),vars.push(hash[0]);var key="undefined"==typeof hash[1]?0:1,n=hash[key].indexOf("#");hash[key]=hash[key].substring(0,n!=-1?n:hash[key].length),vars[hash[0]]=hash[key]}return vars}var ref_cookie=$.cookie("affwp_ref"),credit_last=($.cookie("affwp_ref_visit_id"),$.cookie("affwp_campaign"),AFFWP.referral_credit_last);if("1"==credit_last||!ref_cookie){var ref=affwp_get_query_vars()[AFFWP.referral_var],campaign=affwp_get_query_vars().campaign;if("undefined"==typeof ref||$.isFunction(ref)){var path=window.location.pathname.split("/");$.each(path,function(key,value){AFFWP.referral_var==value&&(ref=path[key+1])})}$.isFunction(ref)||("undefined"==typeof ref||$.isNumeric(ref)?ref&&!ref_cookie?affwp_track_visit(ref,campaign):"1"==credit_last&&ref&&ref_cookie&&ref!==ref_cookie&&($.removeCookie("affwp_ref"),affwp_track_visit(ref,campaign)):$.ajax({type:"POST",data:{action:"affwp_get_affiliate_id",affiliate:ref},url:affwp_scripts.ajaxurl,success:function(response){"1"==response.data.success&&("1"==credit_last&&ref_cookie&&ref_cookie!=response.data.affiliate_id&&$.removeCookie("affwp_ref"),("1"==credit_last&&ref_cookie&&ref_cookie!=response.data.affiliate_id||!ref_cookie)&&affwp_track_visit(response.data.affiliate_id,campaign))}}).fail(function(response){window.console&&window.console.log&&console.log(response)}))}});